# Intro to Ansys HFSS

Ansys HFSS is a 3D electromagnetic simulation software which can be used for simulation of RF signals.
https://www.ansys.com/products/electronics/ansys-hfss

In PAST, we have been using Ansys HFSS for simulating antennas, however there are other software which can do this, such as MATLAB and FEKO. Note that MATLAB is incapable of simulating antennas that require feeds over a gap (such as a practical dipole) rendering it less than useful for most situations. FEKO is more advanced than both HFSS and MATLAB, but requires much more understanding of the software and how to process your own data manually, making it inefficient for no evident changes in results over HFSS.

## Installing Ansys HFSS

Ansys HFSS can be obtained as a student license through the Ansys Electronics Desktop. This also contains other software such as Maxwell and Icepak.

- [Ansys Electronics Desktop](https://www.ansys.com/academic/students/ansys-electronics-desktop-student)

## Simulating a Dipole Antenna

- [Ansys Provided Tutorial](https://innovationspace.ansys.com/product/simulation-of-a-dipole-array-in-ansys-hfss/)

1. Open Ansys Electronics via the Ansys Electronics Desktop 202X RX application installed to your computer.

2. On your screen, you should see the standard ANSYS electronics suite interface. On the left hand side, you should be able to see the **Project Manager** window. A new project should be created already, but if not, on the top left side of the toolbar, the option to create **New** is available.

3. Towards the center of the toolbar, you should see the HFSS project icon, click this and wait for the project workspace to be created.

   We will now start the creation of our dipole. This can be done in two major methods, using defined discrete values, or parameterizing each value. The difference between the two methods is that the parameterized values allow you to easily change the lengths, dimensions or other distances through a simple change of a value in a table, while the discrete values may require you to remake portions of the antenna. For PAST work, you are expected to parameterize your designs. The dipole we will make is fairly simple. It will consist of two flat conductors of length **l**, width **w** and thickness **t**, separated by some gap distance **g**.

   To begin, first do some ballpark calculations for the length of each element and the feed gap spacing:
   - Using some basic properties of waves, which extend to electromagnetic waves, we know that: V = λ × frequency where lambda is the wavelength and frequency is the operating frequency required. Rearranging this, as EM waves move at the speed of light (c = 299,792,458 m/s) lambda = c/f. For an operating frequency used by PAST of 436.5 MHz, we can calculate the wavelength as 0.686809755m or 68.68cm. As we will be simulating a half wave dipole antenna, our total effective length will be half this wavelength, thus 0.3434048775m or 34.34cm.
   - This length describes the length from the start of one dipole, to the end of the other, including any gap. Assuming we use a 5mm gap, that means each length is then 16.92cm.

4. On the HFSS main project screen, you should be able to identify a window with a visible coordinate axis, and in the bottom left corner of this window an orientation axis. Click the X face arrow only to align your view with the YZ plane. In the Draw toolbar menu, you should see some 3D shape icons drawn. Select the rectangular prism.

5. Choose the origin as the first corner point by left-clicking on the viewport.

6. To make sure ANSYS knows we are drawing the first face on the YZ axis, we have to right-click the viewport next, select grid plane, and then YZ. Draw a new arbitrary point somewhere to the top right of the first point at the origin.

7. Using the orientation axis again, rotate it so you can now see the ZY axis as well. Select an arbitrary depth value for the element and place the final point. You should now have a solid rectangular prism.

8. We will start parameterizing the first element. Click on the object and look at the viewport elements context window. It should select an item called **Box1**. Under it, select the item **CreateBox**.

9. For the values, set them to the following:
   - **Position:** 0,0,0 → 0,0, g/2. Note: you will now see an additional context window asking you to assign the variable g. For the Value box, type in **5 mm**. Repeat this variable creation for the remaining in the following values.
   - **XSize:** t = 0.1 mm
   - **YSize:** w = 19 mm
   - **ZSize:** l = 169.2 mm

10. We will now create the second antenna element. We can do this simply by first **copy and pasting** the current element. To do this, first left click on the element in the viewport window, then use your respective copy and paste command until **Box2** shows up in your viewport elements context window as earlier with box1. Select the **CreateBox** under **Box2**.

11. Next, modify the following values to mirror the antenna along the XY plane:
    - **Position:** 0,0, g/2 → 0,0, -g/2
    - **ZSize:** l → -l

12. We now have the basis for our dipole. We will now assign the elements a conductor material property. To do this easily, click on one element, under the properties window, modify the value of the second option **Material** through the **edit** dialogue box. Then search up **stainless steel** and select the option. Either repeat this with the second element, or under the viewport element context window, drag the second element from the **vacuum** solid material to the **stainless_steel** material.

    We will now work on giving the antenna a way to be excited or in layman terms, receive an input to see how it responds.

13. Use your mouse to zoom in on the gap between the two elements.

14. In the draw toolbar menu, select the 2D rectangle icon.

15. Place the two points for the rectangle anywhere, ensuring it is created on the YZ plane.

16. Select **CreateRectangle** under the **Rectangle1** unassigned sheet in the element window.

17. For the values, set them to the following:
    - **Position:** 0,0,0 → t/2, 0, -g/2
    - **YSize:** 19 → w
    - **ZSize:** 5 → g

18. We will assign this an excitation by right-clicking on the rectangle in the viewport, then select **Assign Excitation**, followed by **Port** and finally **Modal Lumped Port**.

19. Keep the full port impedance as 50 ohm and select **Next >**.

20. In the window, under the value for **Integration Line**, left click **None** and then select **New Line**.

21. Next we will choose our first point as the bottom most point on the centre of the rectangle, touching the bottom element. Select the second point as the top most point on the centre of the rectangle so it forms a vertical arrow on the surface of the rectangle, pointing from the bottom element to the top, then select **Next >** and then **Finish**.

22. Before we simulate, we must define a boundary for the simulation to take place in. In the viewport, right-click on some empty space.

23. Select **Create Open Region** and modify the operating frequency to 0.4365 GHz and ensure the Boundary type is set to **Radiation**. Select **OK**.

24. We will now create our analysis setup. On the project manager window on the very left, right click the option in your current project named **Analysis**, then **Add Solution Setup** then followed by **Advanced**.

25. Modify the frequency to 0.4365 GHz again, change the maximum number of passes to 20 and select **OK** and then select **OK** again in the next window.

26. Before we run the simulation, to check everything is okay, under the top menu bar, left click **HFSS** then select **Validation Check**. If you see all ticks, you have followed the guide correctly and can proceed to the next step, else go back and check to make sure you've completed all the steps.

27. On the project manager window on the very left, right click the option in your current project named **Analysis**, then **Analyze All**. Note: we only have 1 analysis here so it is fine to use, but if you have multiple solution setups, you will need to expand the drop down menu and analyze just the one you want to check.

    Once the file is saved and the solution is complete in its entirety, as shown by the progress bar in the lower right of the screen, we can prepare our main plots.

## Plotting

28. On the project manager window on the very left, right click the option in your current project named **Results**, then select **Create Modal Solution Data Report**, followed by **Rectangular Plot**.

29. In the window, under Category, select **S Parameter** and then click **New Report** on the bottom of the window. Now repeat this with **VSWR**.

30. To access your plots, on the project manager window on the very left, right click the option in your current project named **Results**, then expand the drop down menu and double click on **S Parameter Plot1**.

31. To easily see the value at any simulated frequency, right click on some empty space on the plot, select **Marker** and then **Add X Marker**. Drag this around until you find the centre frequency (436.5 MHz). Note the position of the true peak, and how it may not line up as expected. Repeat this for the VSWR plot.

32. To adjust the antenna, we can change the parameter values and resimulate. To do this, on the project manager window on the very left, click on the **HFSSDESIGN1 (Terminal Network)** icon. If your true frequency was lower than 436.5MHz, try decreasing the value **l**, or increase if it was greater than 436.5 MHz. Repeat step 27 to analyze the new antenna layout and observe the plots again. Modify this until you have an antenna lying close to the required frequency.

33. Save your final file.

Here is an example plot of a dipole antenna:
![Antenna Parameter Plot](https://github.com/user-attachments/assets/a09da247-c4ae-47a1-9447-79d14b2e8c70)
